<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HESAPLARIM - EGE DENİZ</title>
  <link rel="icon" href="favicon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0; padding: 0;
    }
    html, body {
      height: 100%;
      width: 100%;
      font-family: 'Poppins', sans-serif;
      background: url('https://i.imgur.com/yslsfnW.jpeg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 40px 20px 80px;
      overflow-x: hidden;
      transition: background 0.6s ease;
    }
    /* Tema 2 */
    body.theme2 {
      background: url('https://i.imgur.com/0R4Zsdr.jpeg') no-repeat center center fixed;
      background-size: cover;
      color: #222;
    }

    main#buttonsContainer {
      margin-top: 40px;
      max-width: 420px;
      width: 100%;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    main#buttonsContainer a, main#buttonsContainer button#openPlaylistBtn {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-weight: 700;
      font-size: 1.1rem;
      text-decoration: none;
      color: inherit;
      background: linear-gradient(45deg, #ff004f, #6600ff, #00e5ff, #ff004f);
      background-size: 300% 300%;
      animation: gradientShift 6s ease infinite;
      box-shadow:
        0 0 8px #ff004f,
        0 0 16px #6600ff,
        0 0 24px #00e5ff,
        inset 0 0 8px #6600ff;
      padding: 18px 0;
      border-radius: 18px;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    body.theme2 main#buttonsContainer a, body.theme2 main#buttonsContainer button#openPlaylistBtn {
      background: linear-gradient(45deg, #e05d00, #b03000, #a0b900, #e05d00);
      box-shadow:
        0 0 8px #e05d00,
        0 0 16px #b03000,
        0 0 24px #a0b900,
        inset 0 0 8px #b03000;
      color: #222;
    }
    main#buttonsContainer a i, main#buttonsContainer button#openPlaylistBtn i {
      font-size: 1.8rem;
      text-shadow: 0 0 8px #fff;
      min-width: 26px;
      text-align: center;
      transition: color 0.3s ease;
    }
    main#buttonsContainer a:hover, main#buttonsContainer button#openPlaylistBtn:hover {
      transform: scale(1.07) rotateZ(2deg);
      box-shadow:
        0 0 15px #ff005f,
        0 0 32px #7700ff,
        0 0 44px #00e5ff,
        inset 0 0 15px #7700ff;
      text-shadow: 0 0 20px #fff;
      color: #fff;
    }
    body.theme2 main#buttonsContainer a:hover, body.theme2 main#buttonsContainer button#openPlaylistBtn:hover {
      box-shadow:
        0 0 15px #ff7f00,
        0 0 32px #d35400,
        0 0 44px #a0b900,
        inset 0 0 15px #d35400;
      color: #333;
    }
    main#buttonsContainer a::after, main#buttonsContainer button#openPlaylistBtn::after {
      content: '';
      position: absolute;
      top: -60%;
      left: -60%;
      width: 220%;
      height: 220%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.12), transparent);
      transform: rotate(25deg);
      animation: shine 4s infinite linear;
      pointer-events: none;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes shine {
      0% { transform: translate(-100%, -100%) rotate(25deg); }
      100% { transform: translate(100%, 100%) rotate(25deg); }
    }

    #playerUI {
      display: none;
      margin-top: 30px;
      max-width: 420px;
      width: 100%;
      background: rgba(0,0,0,0.25);
      border-radius: 18px;
      box-shadow: 0 0 18px rgba(0,255,255,0.15);
      padding: 20px 25px;
      color: #fff;
      user-select: none;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 1rem;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.theme2 #playerUI {
      background: rgba(255,255,255,0.95);
      color: #222;
      box-shadow: 0 0 18px rgba(255,165,0,0.3);
    }

    #currentTrackName {
      font-size: 1.1rem;
      font-weight: 700;
      min-height: 28px;
      text-align: center;
      user-select: text;
    }
    #progressContainer {
      width: 100%;
      height: 12px;
      background: rgba(255,255,255,0.15);
      border-radius: 10px;
      cursor: pointer;
      position: relative;
      user-select: none;
    }
    #progress {
      height: 100%;
      width: 0%;
      background: #00e5ff;
      border-radius: 10px;
      transition: width 0.2s ease;
      box-shadow: 0 0 10px #00e5ff;
    }
    #progressThumb {
      position: absolute;
      top: 50%;
      left: 0%;
      transform: translate(-50%, -50%);
      width: 18px;
      height: 18px;
      background: #00e5ff;
      border-radius: 50%;
      box-shadow: 0 0 8px #00e5ff;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    body.theme2 #progress {
      background: #e05d00;
      box-shadow: 0 0 10px #e05d00;
    }
    body.theme2 #progressThumb {
      background: #e05d00;
      box-shadow: 0 0 8px #e05d00;
    }

    #timeDisplay {
      font-size: 0.9rem;
      font-weight: 500;
      text-align: center;
      user-select: none;
    }
    #controls {
      display: flex;
      justify-content: center;
      gap: 22px;
      margin-top: 8px;
      user-select: none;
    }
    #controls button {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(45deg, #00e5ff, #6600ff);
      color: white;
      cursor: pointer;
      font-size: 1.8rem;
      box-shadow:
        0 0 10px #00e5ff,
        0 0 20px #6600ff;
      transition: background 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
    }
    #controls button:hover {
      background: linear-gradient(45deg, #ff005f, #7700ff);
      box-shadow:
        0 0 14px #ff005f,
        0 0 30px #7700ff;
      color: white;
    }
    body.theme2 #controls button {
      background: linear-gradient(45deg, #e05d00, #b03000);
      box-shadow:
        0 0 10px #e05d00,
        0 0 20px #b03000;
      color: #222;
    }
    body.theme2 #controls button:hover {
      background: linear-gradient(45deg, #ffa500, #b5651d);
      box-shadow:
        0 0 14px #ffa500,
        0 0 30px #b5651d;
      color: #222;
    }

    /* Şarkı Listesi Modal */
    #playlistModal {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.95);
      backdrop-filter: blur(7px);
      display: none;
      justify-content: center;
      align-items: center;
      padding: 24px;
      z-index: 9999;
    }
    body.theme2 #playlistModal {
      background: rgba(255,255,255,0.95);
    }
    #playlistModal.visible {
      display: flex;
    }
    #playlistContent {
      max-width: 700px;
      width: 100%;
      background: rgba(0,0,0,0.75);
      border-radius: 20px;
      padding: 28px 36px 36px;
      box-shadow: 0 0 30px rgba(0,255,255,0.25);
      color: #fff;
      display: flex;
      flex-direction: column;
      gap: 14px;
      user-select: none;
      transition: background 0.4s ease, color 0.4s ease;
    }
    body.theme2 #playlistContent {
      background: rgba(255,255,255,0.95);
      color: #222;
      box-shadow: 0 0 30px rgba(255,165,0,0.35);
    }

    #betaTag {
      font-weight: 700;
      font-size: 1.3rem;
      color: #ff9933;
      margin-bottom: 8px;
      user-select: none;
      display: block;
    }
    #playlistTitle {
      font-weight: 800;
      font-size: 2.1rem;
      margin-bottom: 4px;
      user-select: none;
    }
    #playlistDesc {
      font-size: 1rem;
      color: rgba(255,255,255,0.8);
      margin-bottom: 22px;
      user-select: none;
    }
    body.theme2 #playlistDesc {
      color: rgba(34,34,34,0.8);
    }

    #searchSongs {
      width: 100%;
      padding: 10px 14px;
      font-size: 1rem;
      border-radius: 12px;
      border: none;
      outline: none;
      margin-bottom: 20px;
      user-select: text;
    }

    #songList {
      display: flex;
      flex-direction: column;
      gap: 14px;
      max-height: 320px;
      overflow-y: auto;
    }
    #songList button.songBtn {
      font-size: 1rem;
      padding: 10px 14px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      background: linear-gradient(45deg, #6600ff, #00e5ff);
      color: white;
      box-shadow: 0 0 8px #00e5ff;
      transition: background-color 0.3s ease;
      text-align: left;
      user-select: none;
    }
    #songList button.songBtn:hover {
      background: linear-gradient(45deg, #ff005f, #7700ff);
      box-shadow: 0 0 15px #ff005f;
      color: white;
    }
    body.theme2 #songList button.songBtn {
      background: linear-gradient(45deg, #b5651d, #e05d00);
      box-shadow: 0 0 8px #e05d00;
      color: #222;
    }
    body.theme2 #songList button.songBtn:hover {
      background: linear-gradient(45deg, #ffa500, #d35400);
      box-shadow: 0 0 15px #ffa500;
      color: #222;
    }

    #closeModalBtn {
      align-self: center;
      padding: 10px 30px;
      font-weight: 700;
      font-size: 1.1rem;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      background: linear-gradient(45deg, #ff004f, #6600ff, #00e5ff);
      background-size: 300% 300%;
      color: white;
      box-shadow:
        0 0 8px #ff004f,
        0 0 16px #6600ff,
        0 0 24px #00e5ff;
      transition: all 0.3s ease;
      user-select: none;
    }
    #closeModalBtn:hover {
      background-position: 100% 50%;
      box-shadow:
        0 0 16px #ff005f,
        0 0 28px #7700ff,
        0 0 40px #00e5ff;
      transform: scale(1.05);
    }
    body.theme2 #closeModalBtn {
      background: linear-gradient(45deg, #e05d00, #b03000, #a0b900);
      box-shadow:
        0 0 8px #e05d00,
        0 0 16px #b03000,
        0 0 24px #a0b900;
      color: #222;
    }
    body.theme2 #closeModalBtn:hover {
      background-position: 100% 50%;
      box-shadow:
        0 0 16px #ffa500,
        0 0 28px #b5651d,
        0 0 40px #d35400;
      color: #222;
    }

    footer {
      position: fixed;
      bottom: 12px;
      width: 100%;
      text-align: center;
      font-size: 0.95rem;
      color: rgba(255,255,255,0.7);
      text-shadow: 0 0 4px #000;
      user-select: none;
      z-index: 10;
    }
    body.theme2 footer {
      color: rgba(34,34,34,0.7);
      text-shadow: none;
    }

    #themeToggle {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 44px;
      height: 44px;
      background: linear-gradient(45deg, #ff004f, #6600ff, #00e5ff);
      background-size: 300% 300%;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      box-shadow:
        0 0 10px #ff004f,
        0 0 16px #6600ff,
        0 0 24px #00e5ff;
      color: white;
      font-size: 1.6rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-position 4s ease infinite;
      user-select: none;
      z-index: 10000;
    }
    #themeToggle:hover {
      animation: gradientShift 6s ease infinite;
    }
    body.theme2 #themeToggle {
      background: linear-gradient(45deg, #e05d00, #b03000, #a0b900);
      box-shadow:
        0 0 10px #e05d00,
        0 0 16px #b03000,
        0 0 24px #a0b900;
      color: #222;
    }

    /* Responsive */
    @media (max-width: 520px) {
      main#buttonsContainer {
        max-width: 100%;
        padding: 0 12px;
        gap: 16px;
        grid-template-columns: 1fr 1fr;
      }
      #playerUI {
        max-width: 100%;
        padding: 18px 20px;
      }
      #controls {
        gap: 16px;
      }
      #controls button {
        width: 44px;
        height: 44px;
        font-size: 1.4rem;
      }
      #playlistContent {
        max-width: 95vw;
        padding: 20px 18px 28px;
      }
    }
  </style>
</head>
<body>

  <main id="buttonsContainer" role="navigation" aria-label="Sosyal medya ve müzik menüsü">
    <a href="https://instagram.com/10110310132100101110105l22" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram" aria-hidden="true"></i>Instagram</a>
    <a href="https://t.me/l0110310132100101110105122" target="_blank" rel="noopener noreferrer" aria-label="Telegram"><i class="fab fa-telegram" aria-hidden="true"></i>Telegram</a>
    <a href="https://www.tiktok.com/@010169716901l7" target="_blank" rel="noopener noreferrer" aria-label="TikTok"><i class="fab fa-tiktok" aria-hidden="true"></i>TikTok</a>
    <button id="openPlaylistBtn" aria-haspopup="dialog" aria-expanded="false" aria-controls="playlistModal" aria-label="Şarkı listesi">Şarkı Listesi</button>
  </main>

  <section id="playerUI" aria-live="polite" aria-atomic="true" role="region" aria-label="Müzik çalar">
    <div id="currentTrackName" tabindex="0"></div>
    <div id="progressContainer" aria-label="Şarkı ilerleme çubuğu" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
      <div id="progress"></div>
      <div id="progressThumb" tabindex="-1"></div>
    </div>
    <div id="timeDisplay" aria-live="off" aria-atomic="true" aria-label="Şarkı süresi"></div>
    <div id="controls">
      <button id="prevBtn" aria-label="Önceki şarkı" title="Önceki"><i class="fas fa-backward"></i></button>
      <button id="playPauseBtn" aria-label="Oynat/Durdur" title="Oynat/Durdur"><i class="fas fa-play"></i></button>
      <button id="stopBtn" aria-label="Durdur" title="Durdur"><i class="fas fa-stop"></i></button>
      <button id="nextBtn" aria-label="Sonraki şarkı" title="Sonraki"><i class="fas fa-forward"></i></button>
    </div>
  </section>

  <!-- Şarkı Listesi Modal -->
  <dialog id="playlistModal" role="dialog" aria-modal="true" aria-labelledby="playlistTitle">
    <div id="playlistContent">
      <div id="betaTag">BETA ⚠️</div>
      <h2 id="playlistTitle">Şarkı Listesi</h2>
      <p id="playlistDesc">Şarkı ismine tıklayarak dinlemeye başlayabilirsiniz. Daha fazla eklenecektir 🥳.</p>
      <input type="text" id="searchSongs" aria-label="Şarkı ara" placeholder="Şarkı ara..." />
      <div id="songList" role="list" tabindex="0"></div>
      <button id="closeModalBtn" aria-label="Şarkı listesini kapat">Kapat</button>
    </div>
  </dialog>

  <footer>
    © 2025 Ege Deniz. All rights reserved.
  </footer>

  <button id="themeToggle" aria-label="Tema değiştir" title="Tema değiştir"><i class="fas fa-adjust"></i></button>

  <audio id="bgMusic" preload="auto"></audio>

  <script>
    (() => {
      const body = document.body;
      const themeToggle = document.getElementById('themeToggle');
      const playlistModal = document.getElementById('playlistModal');
      const openPlaylistBtn = document.getElementById('openPlaylistBtn');
      const closeModalBtn = document.getElementById('closeModalBtn');
      const songListContainer = document.getElementById('songList');
      const searchInput = document.getElementById('searchSongs');
      const playerUI = document.getElementById('playerUI');
      const currentTrackName = document.getElementById('currentTrackName');
      const bgMusic = document.getElementById('bgMusic');
      const progressContainer = document.getElementById('progressContainer');
      const progressBar = document.getElementById('progress');
      const progressThumb = document.getElementById('progressThumb');
      const timeDisplay = document.getElementById('timeDisplay');
      const playPauseBtn = document.getElementById('playPauseBtn');
      const stopBtn = document.getElementById('stopBtn');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      // Şarkılar
      const songs = [
        {title: "Juice WRLD - Let Me Know", src:"Juice WRLD Let Me Know (I Wonder Why Freestyle) (Official Audio).mp3"},
        {title: "Doja Cat - Streets", src:"Doja Cat - Streets (Official Audio).mp3"},
        {title: "lliinnee", src:"lliinnee.mp3"},
        {title: "Lana Del Rey - Summertime Sadness", src:"Lana Del Rey - Summertime Sadness (Official Music Video).mp3"},
        {title: "Nicky Jam - Hasta el Amanecer", src:"22. Hasta el Amanecer - Nicky Jam  Video Oficial.mp3"},
        {title: "Amor Na Praia", src:"Amor Na Praia.mp3"},
        {title: "Smezir 2 (Slowed)", src:"smezir 2 (Super Slowed).mp3"},
        {title: "Djo - End Of Beginning", src:"Djo - End Of Beginning (Official Audio).mp3"},
        {title: "Twenty One Pilots - Doubt", src:"twenty-one-pilots-Doubt-_Official-Audio_.mp3"},
        {title: "lil 17th - Mary Jane", src:"lil 17th - Mary Jane.mp3"},
        {title: "XXXTENTACION - MOONLIGHT", src:"XXXTENTACION - MOONLIGHT (OFFICIAL MUSIC VIDEO).mp3"},
        {title: "t.A.T.u. - All The Things She Said", src:"t.A.T.u. - All The Things She Said (Official Music Video).mp3"},
        {title: "Tame Impala - Let It Happen", src:"tame_impala_let_it_happen_mp3_55159.mp3"},
        {title: "Funk - Mi Camino", src:"funk_mi_camino_mp3_55239.mp3"},
      ];

      // LocalStorage anahtarları
      const LS_SONG_INDEX = 'lastSongIndex';
      const LS_SONG_TIME = 'lastSongTime';
      const LS_THEME = 'userTheme';

      let currentSongIndex = 0;
      let isPlaying = false;
      let isSeeking = false;

      // Tema ayarı yükle
      function loadTheme() {
        const savedTheme = localStorage.getItem(LS_THEME);
        if(savedTheme === 'theme2') {
          body.classList.add('theme2');
        } else {
          body.classList.remove('theme2');
        }
      }
      loadTheme();

      // Tema değiştir
      themeToggle.onclick = () => {
        body.classList.toggle('theme2');
        localStorage.setItem(LS_THEME, body.classList.contains('theme2') ? 'theme2' : 'default');
      };

      // Modal aç/kapat
      openPlaylistBtn.onclick = () => {
        playlistModal.showModal();
        openPlaylistBtn.setAttribute('aria-expanded', 'true');
        renderSongList(songs);
        searchInput.value = '';
        searchInput.focus();
      };
      closeModalBtn.onclick = () => {
        playlistModal.close();
        openPlaylistBtn.setAttribute('aria-expanded', 'false');
        openPlaylistBtn.focus();
      };
      playlistModal.addEventListener('cancel', e => {
        e.preventDefault();
        playlistModal.close();
        openPlaylistBtn.setAttribute('aria-expanded', 'false');
        openPlaylistBtn.focus();
      });

      // Şarkı listesini renderla
      function renderSongList(list) {
        songListContainer.innerHTML = '';
        if(list.length === 0) {
          songListContainer.innerHTML = '<p>Aramanızla eşleşen şarkı bulunamadı.</p>';
          return;
        }
        list.forEach((song, idx) => {
          const btn = document.createElement('button');
          btn.textContent = song.title;
          btn.className = 'songBtn';
          btn.setAttribute('role', 'listitem');
          btn.onclick = () => {
            playSong(idx);
            playlistModal.close();
            openPlaylistBtn.setAttribute('aria-expanded', 'false');
            openPlaylistBtn.focus();
          };
          songListContainer.appendChild(btn);
        });
      }

      // Arama inputu
      searchInput.oninput = () => {
        const val = searchInput.value.toLowerCase();
        const filtered = songs.filter(s => s.title.toLowerCase().includes(val));
        renderSongList(filtered);
      };

      // Şarkıyı oynat
      function playSong(index) {
        if(index < 0) index = songs.length -1;
        if(index >= songs.length) index = 0;
        currentSongIndex = index;
        bgMusic.src = songs[index].src;
        bgMusic.load();
        bgMusic.play();
        isPlaying = true;
        playerUI.style.display = 'flex';
        updatePlayPauseBtn();
        updateCurrentTrackName();
        localStorage.setItem(LS_SONG_INDEX, currentSongIndex);
      }

      // Şarkı ismini güncelle
      function updateCurrentTrackName() {
        currentTrackName.textContent = songs[currentSongIndex].title;
      }

      // Oynat/Durdur buton güncelle
      function updatePlayPauseBtn() {
        playPauseBtn.innerHTML = isPlaying ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
        playPauseBtn.setAttribute('aria-label', isPlaying ? 'Durdur' : 'Oynat');
      }

      // Ses ve ilerleme kontrol (ileri/geri sarma yok, sadece şarkı değişir)
      playPauseBtn.onclick = () => {
        if(isPlaying) {
          bgMusic.pause();
          isPlaying = false;
        } else {
          bgMusic.play();
          isPlaying = true;
        }
        updatePlayPauseBtn();
      };

      stopBtn.onclick = () => {
        bgMusic.pause();
        bgMusic.currentTime = 0;
        isPlaying = false;
        updatePlayPauseBtn();
      };

      prevBtn.onclick = () => {
        playSong(currentSongIndex - 1);
      };

      nextBtn.onclick = () => {
        playSong(currentSongIndex + 1);
      };

      // İlerleme çubuğu güncelleme
      bgMusic.ontimeupdate = () => {
        if(!isSeeking) {
          const progressPercent = (bgMusic.currentTime / bgMusic.duration) * 100 || 0;
          progressBar.style.width = progressPercent + '%';
          progressThumb.style.left = progressPercent + '%';
          timeDisplay.textContent = formatTime(bgMusic.currentTime) + ' / ' + formatTime(bgMusic.duration);
          progressContainer.setAttribute('aria-valuenow', Math.floor(progressPercent));
          // LocalStorage'da zaman kaydet
          localStorage.setItem(LS_SONG_TIME, bgMusic.currentTime);
        }
      };

      // İlerleme çubuğuna tıklama ile atlama
      progressContainer.onclick = e => {
        const rect = progressContainer.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const width = rect.width;
        const percent = Math.min(Math.max(clickX / width, 0),1);
        if(bgMusic.duration) {
          bgMusic.currentTime = percent * bgMusic.duration;
        }
      };

      // Şarkı bittiğinde sonraki şarkıya geç
      bgMusic.onended = () => {
        playSong(currentSongIndex + 1);
      };

      // Zaman formatlama fonksiyonu
      function formatTime(sec) {
        if(isNaN(sec)) return "00:00";
        const m = Math.floor(sec / 60);
        const s = Math.floor(sec % 60);
        return (m < 10 ? '0'+m : m) + ':' + (s < 10 ? '0'+s : s);
      }

      // Sayfa açılırken son çalınan şarkı ve pozisyonu yükle
      window.addEventListener('load', () => {
        loadTheme();
        const savedIndex = parseInt(localStorage.getItem(LS_SONG_INDEX));
        const savedTime = parseFloat(localStorage.getItem(LS_SONG_TIME));
        if(!isNaN(savedIndex) && savedIndex >=0 && savedIndex < songs.length) {
          currentSongIndex = savedIndex;
          bgMusic.src = songs[currentSongIndex].src;
          bgMusic.load();
          if(!isNaN(savedTime) && savedTime < bgMusic.duration) {
            bgMusic.currentTime = savedTime;
          }
          playerUI.style.display = 'flex';
          updateCurrentTrackName();
          updatePlayPauseBtn();
        }
      });

      // Klavye ile modal kapatma (ESC)
      window.addEventListener('keydown', e => {
        if(e.key === 'Escape' && playlistModal.open) {
          playlistModal.close();
          openPlaylistBtn.setAttribute('aria-expanded', 'false');
          openPlaylistBtn.focus();
        }
      });

      // Modal kapanınca odağı butona ver
      playlistModal.addEventListener('close', () => {
        openPlaylistBtn.setAttribute('aria-expanded', 'false');
        openPlaylistBtn.focus();
      });
    })();
  </script>
</body>
</html>
