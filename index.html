<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fragments Müzik Botu - Ultra Modern Site</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&display=swap');
  :root {
    --main-color: #00e6ca;
    --main-color-dark: #008080;
    --bg-dark: #121212;
    --bg-darker: #0d0d0d;
    --text-light: #d1fff6;
    --text-muted: #00e6ca88;
    --modal-bg: #121212ee;
  }
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; padding: 0; font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg, #0d0d0d, #004d40);
    color: var(--text-light);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 10px 60px;
  }
  header {
    width: 100%;
    max-width: 900px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    user-select:none;
  }
  #lang-select {
    background: var(--main-color);
    border: none;
    border-radius: 12px;
    padding: 8px 12px;
    font-weight: 700;
    cursor: pointer;
    color: #121212;
    box-shadow: 0 0 12px var(--main-color);
    transition: background-color 0.3s ease;
  }
  #lang-select:hover, #lang-select:focus {
    background: #00ffdd;
    outline: none;
  }
  header h1 {
    margin: 0;
    font-weight: 800;
    font-size: 1.8rem;
    color: var(--main-color);
    animation: colorShift 10s linear infinite;
  }

  main {
    width: 100%;
    max-width: 900px;
    background: var(--bg-dark);
    border-radius: 20px;
    box-shadow: 0 0 30px var(--main-color);
    padding: 30px 40px 40px;
  }
  
  /* MODAL BUTTONS */
  .modal-buttons {
    display: flex;
    gap: 16px;
    justify-content: center;
    margin-bottom: 25px;
  }
  .modal-buttons button {
    flex: 1;
    background: var(--main-color);
    border: none;
    border-radius: 30px;
    padding: 14px 0;
    font-weight: 800;
    font-size: 1.15rem;
    color: #121212;
    cursor: pointer;
    box-shadow: 0 0 25px var(--main-color);
    transition: background-color 0.3s ease;
    user-select:none;
  }
  .modal-buttons button:hover, 
  .modal-buttons button:focus {
    background: #00ffdd;
    outline: none;
    box-shadow: 0 0 40px #00ffdd;
  }

  /* MODAL OVERLAY */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: var(--modal-bg);
    backdrop-filter: blur(14px);
    z-index: 9999;
    align-items: center;
    justify-content: center;
    padding: 15px;
  }
  .modal-overlay.active {
    display: flex;
  }

  /* MODAL CONTENT */
  .modal {
    background: var(--bg-darker);
    border-radius: 20px;
    box-shadow: 0 0 30px var(--main-color);
    max-width: 680px;
    width: 100%;
    max-height: 85vh;
    overflow-y: auto;
    padding: 25px 30px 35px;
    position: relative;
    color: var(--text-light);
    user-select:none;
    animation: modalFade 0.4s ease forwards;
  }

  @keyframes modalFade {
    from {opacity: 0; transform: translateY(-20px);}
    to {opacity: 1; transform: translateY(0);}
  }

  .modal header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
  .modal header h3 {
    margin: 0;
    font-weight: 800;
    font-size: 1.6rem;
    color: var(--main-color);
    user-select:none;
  }
  .modal .close-btn {
    background: none;
    border: none;
    color: var(--main-color);
    font-size: 2rem;
    cursor: pointer;
    user-select:none;
    transition: color 0.3s ease;
  }
  .modal .close-btn:hover,
  .modal .close-btn:focus {
    color: #00ffdd;
    outline: none;
  }

  /* CONTENT AREA (for text modals) */
  .modal-content {
    font-size: 1rem;
    line-height: 1.5;
    user-select: text;
    white-space: pre-line;
  }
  .modal-content a {
    color: var(--main-color);
    text-decoration: none;
  }
  .modal-content a:hover,
  .modal-content a:focus {
    text-decoration: underline;
  }

  /* Yorum butonu ana sayfa */
  #open-comment-modal-btn {
    display: block;
    margin: 0 auto 15px;
    background: var(--main-color);
    border: none;
    border-radius: 50px;
    width: 64px;
    height: 64px;
    font-size: 2rem;
    color: #121212;
    cursor: pointer;
    box-shadow: 0 0 25px var(--main-color);
    transition: background-color 0.3s ease;
    user-select:none;
  }
  #open-comment-modal-btn:hover,
  #open-comment-modal-btn:focus {
    background: #00ffdd;
    outline: none;
    box-shadow: 0 0 40px #00ffdd;
  }
  
  /* Yorum modal form */
  #comment-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  #comment-form input,
  #comment-form textarea {
    background: var(--main-color);
    border: none;
    border-radius: 16px;
    padding: 14px 18px;
    font-weight: 700;
    font-size: 1rem;
    color: #121212;
    outline-offset: 3px;
    outline-color: var(--main-color);
    resize: vertical;
    min-height: 48px;
  }
  #comment-form textarea {
    min-height: 100px;
    resize: vertical;
  }
  #comment-form input:focus,
  #comment-form textarea:focus {
    outline-color: #00ffdd;
  }
  #comment-form button {
    background: var(--main-color);
    color: #121212;
    font-weight: 800;
    font-size: 1.3rem;
    border: none;
    border-radius: 40px;
    padding: 14px 0;
    cursor: pointer;
    box-shadow: 0 0 25px var(--main-color);
    user-select:none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #comment-form button:hover,
  #comment-form button:focus {
    background: #00ffdd;
    box-shadow: 0 0 40px #00ffdd;
    outline: none;
  }

  /* Yorum listesi modal */
  #comments-list {
    max-height: 320px;
    overflow-y: auto;
    list-style: none;
    padding: 0;
    margin: 0 0 20px;
    border: 2px solid var(--main-color);
    border-radius: 20px;
    background: #002a28;
    user-select:text;
  }
  #comments-list li {
    padding: 12px 18px;
    border-bottom: 1px solid var(--main-color);
    color: var(--text-light);
  }
  #comments-list li:last-child {
    border-bottom: none;
  }
  #comments-list li .username {
    font-weight: 800;
    color: var(--main-color);
    margin-bottom: 4px;
  }
  #comments-list li .reply {
    margin-top: 8px;
    font-style: italic;
    color: #00ffddcc;
    background: #004d40;
    padding: 8px 14px;
    border-radius: 14px;
    user-select: text;
  }

  /* Admin Login and Panel Button */
  #admin-login-btn {
    display: block;
    margin: 0 auto 10px;
    background: #008080cc;
    color: var(--text-light);
    font-weight: 700;
    font-size: 1.2rem;
    border: none;
    border-radius: 40px;
    padding: 14px 0;
    width: 100%;
    max-width: 300px;
    cursor: pointer;
    box-shadow: 0 0 30px #008080cc;
    user-select:none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #admin-login-btn:hover,
  #admin-login-btn:focus {
    background: #00a0a0cc;
    box-shadow: 0 0 40px #00a0a0cc;
    outline: none;
  }

  /* Admin Panel Modal bigger */
  #admin-panel-modal .modal {
    max-width: 720px;
  }
  #admin-comments-list {
    list-style: none;
    padding: 0;
    max-height: 400px;
    overflow-y: auto;
  }
  #admin-comments-list li {
    border-bottom: 1px solid var(--main-color);
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    user-select:text;
    color: var(--text-light);
  }
  #admin-comments-list li:last-child {
    border-bottom: none;
  }
  #admin-comments-list li .username {
    color: var(--main-color);
    font-weight: 800;
    min-width: 120px;
    flex-shrink: 0;
  }
  #admin-comments-list li .text {
    flex: 1;
    white-space: pre-wrap;
  }
  #admin-comments-list li .btn-group button {
    cursor: pointer;
    border-radius: 20px;
    border: none;
    padding: 6px 14px;
    font-weight: 700;
    user-select:none;
    transition: background-color 0.3s ease;
  }
  #admin-comments-list li .btn-reply {
    background: #008080cc;
    color: var(--text-light);
    margin-right: 8px;
  }
  #admin-comments-list li .btn-reply:hover,
  #admin-comments-list li .btn-reply:focus {
    background: #00a0a0cc;
    outline: none;
  }
  #admin-comments-list li .btn-delete {
    background: #f44336cc;
    color: #fff;
  }
  #admin-comments-list li .btn-delete:hover,
  #admin-comments-list li .btn-delete:focus {
    background: #ff6666cc;
    outline: none;
  }

  /* Admin Login Modal */
  #admin-login-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  #admin-login-form input {
    padding: 14px 16px;
    font-weight: 700;
    font-size: 1.1rem;
    border-radius: 16px;
    border: none;
    background: var(--main-color);
    color: #121212;
    outline-offset: 2px;
    outline-color: var(--main-color);
  }
  #admin-login-form input:focus {
    outline-color: #00ffdd;
  }
  #admin-login-form button {
    background: var(--main-color);
    border: none;
    border-radius: 40px;
    padding: 14px 0;
    font-weight: 800;
    font-size: 1.3rem;
    color: #121212;
    cursor: pointer;
    box-shadow: 0 0 30px var(--main-color);
    user-select:none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #admin-login-form button:hover,
  #admin-login-form button:focus {
    background: #00ffdd;
    box-shadow: 0 0 40px #00ffddaa;
    outline: none;
  }
  #admin-login-error {
    color: #f44336;
    font-weight: 700;
    margin-top: 6px;
    display: none;
    user-select:none;
  }

  /* Scrollbars */
  #comments-list::-webkit-scrollbar,
  #admin-comments-list::-webkit-scrollbar {
    width: 8px;
  }
  #comments-list::-webkit-scrollbar-thumb,
  #admin-comments-list::-webkit-scrollbar-thumb {
    background: var(--main-color);
    border-radius: 4px;
  }

  /* Animasyonlu renk geçişi */
  @keyframes colorShift {
    0%, 100% { color: #00e6ca; }
    25% { color: #00ffdd; }
    50% { color: #00a0a0; }
    75% { color: #008080; }
  }

</style>
</head>
<body>

<header>
  <h1 id="main-title" class="color-shift">🎧 Fragments Müzik Botu</h1>
  <select id="lang-select" aria-label="Dil seçimi">
    <option value="tr">Türkçe</option>
    <option value="en">English</option>
    <option value="ru">Русский</option>
    <option value="ar">العربية</option>
  </select>
</header>

<main role="main" aria-label="Fragments Müzik Botu ana içeriği">

  <div class="modal-buttons" role="region" aria-label="Modallar için butonlar">
    <button type="button" class="open-modal-btn" data-modal="commands" aria-haspopup="dialog" aria-controls="modal" aria-expanded="false">Komutlar</button>
    <button type="button" class="open-modal-btn" data-modal="privacy" aria-haspopup="dialog" aria-controls="modal" aria-expanded="false">Gizlilik Politikası</button>
    <button type="button" class="open-modal-btn" data-modal="terms" aria-haspopup="dialog" aria-controls="modal" aria-expanded="false">Kullanım Koşulları</button>
    <button type="button" class="open-modal-btn" data-modal="links" aria-haspopup="dialog" aria-controls="modal" aria-expanded="false">Bağlantılar</button>
  </div>

  <button id="open-comment-modal-btn" aria-haspopup="dialog" aria-controls="comment-modal" aria-expanded="false" aria-label="Yorum yaz">💬</button>

  <button id="admin-login-btn" aria-haspopup="dialog" aria-controls="admin-modal" aria-expanded="false">Admin Girişi</button>

</main>

<!-- Ana Modal (komutlar, gizlilik, kullanım, bağlantılar) -->
<div class="modal-overlay" id="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-hidden="true" tabindex="-1">
  <div class="modal" role="document" tabindex="0">
    <header>
      <h3 id="modal-title"></h3>
      <button class="close-btn" aria-label="Kapat">&times;</button>
    </header>
    <div id="content-area" class="modal-content" tabindex="0"></div>
  </div>
</div>

<!-- Yorum Modal -->
<div class="modal-overlay" id="comment-modal" role="dialog" aria-modal="true" aria-labelledby="comment-modal-title" aria-hidden="true" tabindex="-1">
  <div class="modal" role="document" tabindex="0" style="max-width:600px;">
    <header>
      <h3 id="comment-modal-title">Yorumlar</h3>
      <button class="close-btn" aria-label="Kapat">&times;</button>
    </header>
    <ul id="comments-list" aria-live="polite" aria-relevant="additions" aria-label="Yorumlar listesi">
      <!-- Yorumlar buraya -->
    </ul>
    <form id="comment-form" aria-label="Yorum gönderme formu" novalidate>
      <input type="text" id="comment-username" name="username" placeholder="Kullanıcı adınız *" autocomplete="off" required aria-required="true" />
      <textarea id="comment-text" name="comment" placeholder="Yorumunuz *" rows="4" required aria-required="true"></textarea>
      <button type="submit" aria-label="Yorum gönder">Yorum Gönder</button>
    </form>
  </div>
</div>

<!-- Admin Login Modal -->
<div class="modal-overlay" id="admin-modal" role="dialog" aria-modal="true" aria-labelledby="admin-modal-title" aria-hidden="true" tabindex="-1">
  <div class="modal" role="document" tabindex="0" style="max-width: 480px;">
    <header>
      <h3 id="admin-modal-title">Admin Girişi</h3>
      <button class="close-btn" aria-label="Kapat">&times;</button>
    </header>
    <form id="admin-login-form" aria-label="Admin şifre girişi formu" novalidate>
      <input type="password" id="admin-password" name="password" placeholder="Şifre" autocomplete="off" required aria-required="true" />
      <button type="submit">Giriş Yap</button>
      <div id="admin-login-error" role="alert" aria-live="assertive"></div>
    </form>
  </div>
</div>

<!-- Admin Panel Modal -->
<div class="modal-overlay" id="admin-panel-modal" role="dialog" aria-modal="true" aria-labelledby="admin-panel-modal-title" aria-hidden="true" tabindex="-1">
  <div class="modal" role="document" tabindex="0">
    <header>
      <h3 id="admin-panel-modal-title">Admin Paneli</h3>
      <button class="close-btn" aria-label="Kapat">&times;</button>
    </header>
    <ul id="admin-comments-list" aria-label="Yorumlar yönetim listesi">
      <!-- Admin yorumları -->
    </ul>
  </div>
</div>

<script>
(() => {
  'use strict';

  const ADMIN_PASSWORD = 'xFragmentS';

  // Çoklu dil içerikleri
  const content = {
    tr: {
      commands: `
• /surem - Premium sürenizi gösterir
• /premiumol - Premium özellikleri gösterir
• /gecmisim - (Premium) Son 10 şarkıyı gösterir
• /hediyepremium [id] - (Yönetici) Premium verir
• /bakimac - (Yönetici) Bakım modunu açar
• /bakimkapat - (Yönetici) Bakım modunu kapatır
      `,
      privacy: `
Fragments botunuz gizliliğinizi önemser.
Veriler yalnızca hizmet kalitesi için kullanılır.
Veriler üçüncü şahıslarla paylaşılmaz.

Telegram üzerinden geliştiriciye veya destek hattına mesaj göndermek yasaktır.
🔒 Bu tür girişimler otomatik olarak tespit edilir, tüm kullanıcı verileri silinir ve kullanıcı engellenir.
Lütfen sadece e-posta kullanın:
📩 contact@egeherz.com
      `,
      terms: `
Fragments botu sadece müzik indirme amaçlıdır.
Geliştirici uyarılarına uyunuz.
Yasadışı veya zararlı kullanımlar yasaktır.
Kullanım sorumluluğu kullanıcıya aittir.

Sorular için: contact@egeherz.com
      `,
      links: `
<a href="https://t.me/fragmentsduyuru" target="_blank" rel="noopener noreferrer">📢 Duyuru Kanalı</a><br/>
<a href="https://t.me/fragmentsmuzik" target="_blank" rel="noopener noreferrer">👥 Topluluk Grubu</a><br/>
<a href="https://t.me/l0110310132100101110105122" target="_blank" rel="noopener noreferrer">👨‍💻 Geliştirici</a><br/>
<a href="https://t.me/FragmentsofmeBOT" target="_blank" rel="noopener noreferrer">🤖 Botu Aç</a>
      `
    },
    en: {
      commands: `
• /surem - Show your premium duration
• /premiumol - Show premium features
• /gecmisim - (Premium) Show last 10 songs
• /hediyepremium [id] - (Admin) Grant premium
• /bakimac - (Admin) Enable maintenance mode
• /bakimkapat - (Admin) Disable maintenance mode
      `,
      privacy: `
Fragments bot respects your privacy.
Data is used only to improve service.
No data shared with third parties.

Messaging developer or support on Telegram is forbidden.
🔒 Such attempts are detected automatically; all user data deleted and user banned.
Please use email only:
📩 contact@egeherz.com
      `,
      terms: `
Fragments bot is for music downloads only.
Follow developer warnings.
Illegal or harmful use prohibited.
User is responsible.

For inquiries: contact@egeherz.com
      `,
      links: `
<a href="https://t.me/fragmentsduyuru" target="_blank" rel="noopener noreferrer">📢 Announcement Channel</a><br/>
<a href="https://t.me/fragmentsmuzik" target="_blank" rel="noopener noreferrer">👥 Community Group</a><br/>
<a href="https://t.me/l0110310132100101110105122" target="_blank" rel="noopener noreferrer">👨‍💻 Developer</a><br/>
<a href="https://t.me/FragmentsofmeBOT" target="_blank" rel="noopener noreferrer">🤖 Open Bot</a>
      `
    },
    ru: {
      commands: `
• /surem - Показать время премиума
• /premiumol - Показать премиум функции
• /gecmisim - (Премиум) Показать последние 10 песен
• /hediyepremium [id] - (Админ) Дать премиум
• /bakimac - (Админ) Включить режим обслуживания
• /bakimkapat - (Админ) Выключить режим обслуживания
      `,
      privacy: `
Бот Fragments уважает вашу конфиденциальность.
Данные используются только для улучшения сервиса.
Данные не передаются третьим лицам.

Запрещено писать разработчику или в поддержку через Telegram.
🔒 Такие попытки автоматически обнаруживаются; все данные пользователя удаляются, пользователь блокируется.
Используйте только email:
📩 contact@egeherz.com
      `,
      terms: `
Бот Fragments предназначен только для загрузки музыки.
Следуйте предупреждениям разработчика.
Запрещено незаконное или вредоносное использование.
Ответственность пользователя.

Вопросы: contact@egeherz.com
      `,
      links: `
<a href="https://t.me/fragmentsduyuru" target="_blank" rel="noopener noreferrer">📢 Канал объявлений</a><br/>
<a href="https://t.me/fragmentsmuzik" target="_blank" rel="noopener noreferrer">👥 Сообщество</a><br/>
<a href="https://t.me/l0110310132100101110105122" target="_blank" rel="noopener noreferrer">👨‍💻 Разработчик</a><br/>
<a href="https://t.me/FragmentsofmeBOT" target="_blank" rel="noopener noreferrer">🤖 Открыть бота</a>
      `
    },
    ar: {
      commands: `
• /surem - عرض مدة البريميوم
• /premiumol - عرض مزايا البريميوم
• /gecmisim - (بريميوم) عرض آخر 10 أغاني
• /hediyepremium [id] - (مدير) منح بريميوم
• /bakimac - (مدير) تفعيل وضع الصيانة
• /bakimkapat - (مدير) تعطيل وضع الصيانة
      `,
      privacy: `
بوت فراغمنتس يحترم خصوصيتك.
تُستخدم البيانات فقط لتحسين أداء البوت وتجربة المستخدم.
لا يتم مشاركة بياناتك مع أي طرف ثالث.

الرسائل إلى المطور أو الدعم عبر Telegram ممنوعة.
🔒 يتم كشف هذه المحاولات آليًا، وتحذف جميع بيانات المستخدم، ويُحظر المستخدم.
يرجى استخدام البريد الإلكتروني فقط:
📩 contact@egeherz.com
      `,
      terms: `
باستخدام بوت فراغمنتس، أنت توافق على الشروط التالية:
- البوت مخصص لتنزيل الموسيقى فقط.
- اتبع تحذيرات المطور للحفاظ على استقرار الخدمة.
- يمنع الاستخدام غير القانوني أو الضار.
- المسؤولية تقع على المستخدم.

لأي استفسارات، يرجى مراسلة contact@egeherz.com.
      `,
      links: `
<a href="https://t.me/fragmentsduyuru" target="_blank" rel="noopener noreferrer">📢 قناة الإعلانات</a><br/>
<a href="https://t.me/fragmentsmuzik" target="_blank" rel="noopener noreferrer">👥 مجموعة المجتمع</a><br/>
<a href="https://t.me/l0110310132100101110105122" target="_blank" rel="noopener noreferrer">👨‍💻 المطور</a><br/>
<a href="https://t.me/FragmentsofmeBOT" target="_blank" rel="noopener noreferrer">🤖 افتح البوت</a>
      `
    }
  };

  // Elements
  const modalOverlay = document.getElementById('modal');
  const modalTitle = document.getElementById('modal-title');
  const contentArea = document.getElementById('content-area');
  const openModalButtons = document.querySelectorAll('.open-modal-btn');
  const closeModalBtn = modalOverlay.querySelector('.close-btn');

  const langSelect = document.getElementById('lang-select');
  const mainTitle = document.getElementById('main-title');

  const commentModal = document.getElementById('comment-modal');
  const openCommentBtn = document.getElementById('open-comment-modal-btn');
  const commentCloseBtn = commentModal.querySelector('.close-btn');
  const commentForm = document.getElementById('comment-form');
  const commentsList = document.getElementById('comments-list');
  const commentUsername = document.getElementById('comment-username');
  const commentText = document.getElementById('comment-text');

  const adminLoginBtn = document.getElementById('admin-login-btn');
  const adminModal = document.getElementById('admin-modal');
  const adminLoginForm = document.getElementById('admin-login-form');
  const adminPasswordInput = document.getElementById('admin-password');
  const adminLoginError = document.getElementById('admin-login-error');

  const adminPanelModal = document.getElementById('admin-panel-modal');
  const adminCommentsList = document.getElementById('admin-comments-list');

  // Save/load comments localStorage key
  const STORAGE_KEY = 'fragments_comments';

  // Store comments in memory
  let comments = [];

  // --- FUNCTIONS ---

  // Load comments from localStorage
  function loadComments() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      try {
        comments = JSON.parse(saved);
      } catch {
        comments = [];
      }
    }
  }

  // Save comments to localStorage
  function saveComments() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(comments));
  }

  // Render comments in modal
  function renderComments() {
    commentsList.innerHTML = '';
    comments.forEach((c, i) => {
      const li = document.createElement('li');
      const userSpan = document.createElement('div');
      userSpan.textContent = c.username;
      userSpan.className = 'username';
      li.appendChild(userSpan);

      const textSpan = document.createElement('div');
      textSpan.textContent = c.text;
      li.appendChild(textSpan);

      if(c.reply) {
        const replyDiv = document.createElement('div');
        replyDiv.className = 'reply';
        replyDiv.textContent = 'Admin yanıtı: ' + c.reply;
        li.appendChild(replyDiv);
      }
      commentsList.appendChild(li);
    });
  }

  // Render comments for admin panel with controls
  function renderAdminComments() {
    adminCommentsList.innerHTML = '';
    comments.forEach((c,i) => {
      const li = document.createElement('li');

      const userDiv = document.createElement('div');
      userDiv.textContent = c.username;
      userDiv.className = 'username';
      li.appendChild(userDiv);

      const textDiv = document.createElement('div');
      textDiv.textContent = c.text;
      textDiv.className = 'text';
      li.appendChild(textDiv);

      const btnGroup = document.createElement('div');
      btnGroup.className = 'btn-group';

      // Reply button
      const replyBtn = document.createElement('button');
      replyBtn.textContent = 'Yanıtla';
      replyBtn.className = 'btn-reply';
      replyBtn.type = 'button';
      replyBtn.addEventListener('click', () => {
        const answer = prompt('Bu yoruma yanıt yazın:', c.reply || '');
        if(answer !== null) {
          comments[i].reply = answer.trim();
          saveComments();
          renderComments();
          renderAdminComments();
        }
      });
      btnGroup.appendChild(replyBtn);

      // Delete button
      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Sil';
      deleteBtn.className = 'btn-delete';
      deleteBtn.type = 'button';
      deleteBtn.addEventListener('click', () => {
        if(confirm('Bu yorumu silmek istediğine emin misin?')) {
          comments.splice(i,1);
          saveComments();
          renderComments();
          renderAdminComments();
        }
      });
      btnGroup.appendChild(deleteBtn);

      li.appendChild(btnGroup);
      adminCommentsList.appendChild(li);
    });
  }

  // Show modal with content
  function openModal(name) {
    const lang = langSelect.value;
    modalTitle.textContent = {
      commands: {tr:'Komutlar',en:'Commands',ru:'Команды',ar:'الأوامر'}[lang],
      privacy: {tr:'Gizlilik Politikası',en:'Privacy Policy',ru:'Политика конфиденциальности',ar:'سياسة الخصوصية'}[lang],
      terms: {tr:'Kullanım Koşulları',en:'Terms of Use',ru:'Условия использования',ar:'شروط الاستخدام'}[lang],
      links: {tr:'Bağlantılar',en:'Links',ru:'Ссылки',ar:'روابط'}[lang],
    }[name];
    contentArea.innerHTML = content[lang][name];
    modalOverlay.classList.add('active');
    modalOverlay.setAttribute('aria-hidden', 'false');
    // Aria-expanded for buttons
    openModalButtons.forEach(btn => {
      btn.setAttribute('aria-expanded', btn.dataset.modal === name ? 'true' : 'false');
    });
    modalOverlay.querySelector('.modal').focus();
  }

  // Close modal function
  function closeModal() {
    modalOverlay.classList.remove('active');
    modalOverlay.setAttribute('aria-hidden', 'true');
    openModalButtons.forEach(btn => btn.setAttribute('aria-expanded', 'false'));
  }

  // Update texts on lang change
  function updateTexts(lang) {
    mainTitle.textContent = {
      tr: '🎧 Fragments Müzik Botu',
      en: '🎧 Fragments Music Bot',
      ru: '🎧 Фрагменты Музыкальный Бот',
      ar: '🎧 بوت فراغمنتس للموسيقى'
    }[lang];
  }

  // Open comment modal
  function openCommentModal() {
    commentModal.classList.add('active');
    commentModal.setAttribute('aria-hidden', 'false');
    openCommentBtn.setAttribute('aria-expanded', 'true');
    commentModal.querySelector('.modal').focus();
  }
  // Close comment modal
  function closeCommentModal() {
    commentModal.classList.remove('active');
    commentModal.setAttribute('aria-hidden', 'true');
    openCommentBtn.setAttribute('aria-expanded', 'false');
    commentUsername.value = '';
    commentText.value = '';
  }

  // Open admin modal
  function openAdminModal() {
    adminLoginError.style.display = 'none';
    adminPasswordInput.value = '';
    adminModal.classList.add('active');
    adminModal.setAttribute('aria-hidden', 'false');
    adminModal.querySelector('.modal').focus();
    adminLoginBtn.setAttribute('aria-expanded', 'true');
  }
  // Close admin modal
  function closeAdminModal() {
    adminModal.classList.remove('active');
    adminModal.setAttribute('aria-hidden', 'true');
    adminLoginBtn.setAttribute('aria-expanded', 'false');
    adminLoginBtn.focus();
  }
  // Close admin panel modal
  function closeAdminPanelModal() {
    adminPanelModal.classList.remove('active');
    adminPanelModal.setAttribute('aria-hidden', 'true');
    adminLoginBtn.focus();
  }

  // Open admin panel modal
  function openAdminPanel() {
    renderAdminComments();
    adminPanelModal.classList.add('active');
    adminPanelModal.setAttribute('aria-hidden', 'false');
    adminPanelModal.querySelector('.modal').focus();
  }

  // Validate and add comment
  function addComment(username, text) {
    if(!username.trim() || !text.trim()) return false;
    comments.push({username: username.trim(), text: text.trim()});
    saveComments();
    renderComments();
    return true;
  }

  // --- EVENT LISTENERS ---

  // Modal open buttons
  openModalButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      openModal(btn.dataset.modal);
    });
  });

  // Modal close buttons
  closeModalBtn.addEventListener('click', closeModal);
  modalOverlay.addEventListener('click', e => {
    if(e.target === modalOverlay) closeModal();
  });

  // Language select
  langSelect.addEventListener('change', e => {
    const lang = e.target.value;
    localStorage.setItem('lang', lang);
    updateTexts(lang);
    if(modalOverlay.classList.contains('active')){
      // If modal open, update content
      openModal(openModalButtons[0].dataset.modal);
    }
  });

  // On load set lang
  document.addEventListener('DOMContentLoaded', () => {
    const lang = localStorage.getItem('lang') || 'tr';
    langSelect.value = lang;
    updateTexts(lang);
    loadComments();
    renderComments();
  });

  // Comment modal open/close
  openCommentBtn.addEventListener('click', openCommentModal);
  commentCloseBtn.addEventListener('click', closeCommentModal);
  commentModal.addEventListener('click', e => {
    if(e.target === commentModal) closeCommentModal();
  });

  // Submit comment form
  commentForm.addEventListener('submit', e => {
    e.preventDefault();
    const usernameVal = commentUsername.value;
    const textVal = commentText.value;
    if(!usernameVal.trim() || !textVal.trim()) {
      alert('Lütfen kullanıcı adınızı ve yorumunuzu boş bırakmayınız!');
      return;
    }
    if(addComment(usernameVal, textVal)) {
      commentForm.reset();
      commentUsername.focus();
    }
  });

  // Admin modal open/close
  adminLoginBtn.addEventListener('click', openAdminModal);
  adminModal.querySelector('.close-btn').addEventListener('click', closeAdminModal);
  adminModal.addEventListener('click', e => {
    if(e.target === adminModal) closeAdminModal();
  });

  // Admin login form submit
  adminLoginForm.addEventListener('submit', e => {
    e.preventDefault();
    const pass = adminPasswordInput.value.trim();
    if(pass === ADMIN_PASSWORD) {
      closeAdminModal();
      openAdminPanel();
    } else {
      adminLoginError.textContent = 'Yanlış şifre!';
      adminLoginError.style.display = 'block';
      adminPasswordInput.focus();
    }
  });

  // Admin panel modal close
  adminPanelModal.querySelector('.close-btn').addEventListener('click', closeAdminPanelModal);
  adminPanelModal.addEventListener('click', e => {
    if(e.target === adminPanelModal) closeAdminPanelModal();
  });

})();
</script>

</body>
</html>
